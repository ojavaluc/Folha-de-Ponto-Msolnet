<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sistema de Ponto</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Sistema de Ponto</h1>

    <div class="form">
      <input type="password" id="senha" placeholder="Digite sua senha (6 dígitos)" maxlength="6" />
      <select id="tipo">
        <option value="Entrada">Entrada</option>
        <option value="Saída">Saída</option>
      </select>
      <button onclick="registrarPonto()">Registrar</button>
      <button onclick="acessarAdmin()">Área do Administrador</button>
    </div>

    <table id="tabela">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Tipo</th>
          <th>Data</th>
          <th>Hora</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const registros = JSON.parse(localStorage.getItem('registros')) || [];
    const funcionarios = JSON.parse(localStorage.getItem('funcionarios')) || [];

    function registrarPonto() {
      const senha = document.getElementById('senha').value.trim();
      const tipo = document.getElementById('tipo').value;

      if (!senha || senha.length !== 6) {
        alert('Digite sua senha de 6 dígitos.');
        return;
      }

      const funcionario = funcionarios.find(f => f.senha === senha);

      if (!funcionario) {
        alert('Senha não encontrada. Verifique com o administrador.');
        return;
      }

      const agora = new Date();
      const data = agora.toLocaleDateString('pt-BR');
      const hora = agora.toLocaleTimeString('pt-BR');

      registros.push({ nome: funcionario.nome, tipo, data, hora });
      localStorage.setItem('registros', JSON.stringify(registros));
      atualizarTabela();
      document.getElementById('senha').value = '';
    }

    function atualizarTabela() {
      const tbody = document.querySelector('#tabela tbody');
      tbody.innerHTML = '';

      const registrosOrdenados = [...registros].reverse();

      registrosOrdenados.forEach(r => {
        const icone = r.tipo === 'Entrada' ? '🔓' : '🔒';
        const linha = `<tr>
          <td>${r.nome}</td>
          <td>${icone} ${r.tipo}</td>
          <td>${r.data}</td>
          <td>${r.hora}</td>
        </tr>`;
        tbody.innerHTML += linha;
      });
    }

    function acessarAdmin() {
      window.location.href = 'login.html';
    }

    atualizarTabela();
  </script>
</body>
</html>
